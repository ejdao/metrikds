"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[6024],{6024:(N,p,r)=>{r.r(p),r.d(p,{EntidadesPage:()=>U});var d=r(5861),m=r(6895),l=r(4006),f=r(7155),i=r(2879),h=r(8423),s=r(3200);class b extends l.cw{constructor(){super({tipo_documento:new l.NI(1,[s.X1]),numero_documento:new l.NI(null,[s.C1,(0,s.BS)(20)]),tipo:new l.NI(1,[s.X1]),nombre_completo:new l.NI(null,[s.C1,(0,s.BS)(100)]),telefono:new l.NI(null,[s.C1,(0,s.BS)(15)])})}get tipo_documento(){return this.get("tipo_documento")}get numero_documento(){return this.get("numero_documento")}get tipo(){return this.get("tipo")}get nombre_completo(){return this.get("nombre_completo")}get telefono(){return this.get("telefono")}get model(){return{tipo_documento:1,numero_documento:this.numero_documento.value,tipo_id:1,nombre_completo:(this.nombre_completo.value||"").toUpperCase(),telefono:this.telefono.value}}}var e=r(4650),Z=r(2798),v=r(9109);function x(n,c){if(1&n){const t=e.EpF();e.TgZ(0,"ion-buttons",5)(1,"ion-button",11),e.NdJ("click",function(){e.CHM(t);const a=e.oxw();return e.KtG(a.filter.setValue(""))}),e._UZ(2,"ion-icon",12),e.qZA()()}}function C(n,c){1&n&&(e.TgZ(0,"b"),e._uU(1,"Ultima evaluaci\xf3n hace"),e.qZA())}function T(n,c){1&n&&(e.TgZ(0,"b"),e._uU(1,"Ninguna evaluaci\xf3n realizada"),e.qZA())}function E(n,c){if(1&n&&(e.TgZ(0,"div")(1,"ion-card-content",17)(2,"b"),e._uU(3,"Representante:"),e.qZA(),e._uU(4),e._UZ(5,"br")(6,"br"),e.qZA()()),2&n){const t=e.oxw().$implicit;e.xp6(4),e.hij(" ",t.representante.nombre_completo,"")}}function O(n,c){if(1&n&&(e.TgZ(0,"div")(1,"ion-card-content",17)(2,"b"),e._uU(3,"Entidad:"),e.qZA(),e._uU(4),e._UZ(5,"br")(6,"br"),e.qZA()()),2&n){const t=e.oxw().$implicit;e.xp6(4),e.hij(" ",t.entidad.nombre_completo,"")}}function A(n,c){if(1&n){const t=e.EpF();e.TgZ(0,"div",18)(1,"ion-select",19),e.NdJ("ionChange",function(a){e.CHM(t);const _=e.oxw().$implicit,u=e.oxw();return e.KtG(u.clickOnEvaluar(_,a))}),e.TgZ(2,"ion-select-option",20),e._uU(3," MATRIZ VERIF. COND. CALIDAD DEL PROCESO "),e.qZA()()()}2&n&&(e.xp6(2),e.Q6J("value",1))}function y(n,c){if(1&n&&(e.TgZ(0,"ion-card",13)(1,"ion-card-header")(2,"ion-card-title"),e._uU(3),e._UZ(4,"br"),e.TgZ(5,"span",14),e._uU(6),e.qZA(),e._UZ(7,"br"),e.TgZ(8,"ion-card-subtitle"),e.YNc(9,C,2,0,"b",15),e._uU(10),e.ALo(11,"timeFromNow"),e.YNc(12,T,2,0,"b",15),e._UZ(13,"br"),e.TgZ(14,"b"),e._uU(15,"Telefono:"),e.qZA(),e._uU(16),e.qZA()()(),e.YNc(17,E,7,1,"div",15),e.YNc(18,O,7,1,"div",15),e.YNc(19,A,4,1,"div",16),e.qZA()),2&n){const t=c.$implicit;e.xp6(3),e.AsE(" ",t.nombre_completo," (",t.nombre_tipo_entidad,")"),e.xp6(3),e.hij(" Doc. ",t.numero_documento," "),e.xp6(3),e.Q6J("ngIf",t.fecha_ultima_evaluacion),e.xp6(1),e.hij(" ",e.lcZ(11,10,t.fecha_ultima_evaluacion)," "),e.xp6(2),e.Q6J("ngIf",!t.fecha_ultima_evaluacion),e.xp6(4),e.hij(" ",t.telefono," "),e.xp6(1),e.Q6J("ngIf",t.representante),e.xp6(1),e.Q6J("ngIf",t.entidad),e.xp6(1),e.Q6J("ngIf",t.min_time_last_eva_valid)}}function P(n,c){if(1&n){const t=e.EpF();e.TgZ(0,"ion-header")(1,"ion-toolbar")(2,"ion-title"),e._uU(3,"Agregar entidad"),e.qZA(),e.TgZ(4,"ion-buttons",5)(5,"ion-button",3),e.NdJ("click",function(){e.CHM(t);const a=e.oxw();return e.KtG(a.clickOnToggleModal(!1))}),e._uU(6,"Cerrar"),e.qZA()()()(),e.TgZ(7,"ion-content")(8,"ion-list")(9,"ion-item"),e._UZ(10,"ion-input",21),e.qZA(),e.TgZ(11,"ion-item"),e._UZ(12,"ion-input",22),e.qZA(),e.TgZ(13,"ion-item"),e._UZ(14,"ion-input",23),e.qZA()(),e._UZ(15,"br")(16,"br"),e.TgZ(17,"div",24)(18,"ion-button",25),e.NdJ("click",function(){e.CHM(t);const a=e.oxw();return e.KtG(a.clickOnRegistrarEntidad())}),e._uU(19," REGISTRAR "),e.qZA()()()}if(2&n){const t=e.oxw();e.xp6(10),e.Q6J("formControl",t.myForm.numero_documento),e.xp6(2),e.Q6J("formControl",t.myForm.nombre_completo),e.xp6(2),e.Q6J("formControl",t.myForm.telefono),e.xp6(4),e.Q6J("disabled",t.myForm.invalid)}}let U=(()=>{class n{constructor(t,o,a,_){this._entidadesCrud=t,this._alertController=o,this._loadingCtrl=a,this._cd=_,this.dataSource=new f.by([]),this.filter=new l.NI(""),this.myForm=new b,this.isModalOpen=!1,this._subs1=this.filter.valueChanges.subscribe(u=>{this.dataSource.filter=(u||"").trim().toLowerCase()})}ngOnInit(){var t=this;return(0,d.Z)(function*(){t._fetchEntidades()})()}refresh(){this._fetchEntidades(!0)}clickOnToggleModal(t){t?this.isModalOpen=!0:(this.isModalOpen=!1,this.myForm.reset())}clickOnEvaluar(t,o){var a=this;return(0,d.Z)(function*(){var u;yield a._showLoading("Creando nueva evaluaci\xf3n..."),(yield a._entidadesCrud.evaluar(t,o.detail.value)).fold({right:(u=(0,d.Z)(function*(){yield(yield a._alertController.create({header:"Estado de la evaluaci\xf3n",message:"Evaluaci\xf3n creada satisfactoriamente",buttons:["OK"]})).present()}),function(){return u.apply(this,arguments)}),left:function(){var u=(0,d.Z)(function*(){yield(yield a._alertController.create({header:"Estado de la evaluaci\xf3n",message:"Algo sali\xf3 mal al crear la evaluaci\xf3n",buttons:["OK"]})).present()});return function(){return u.apply(this,arguments)}}()}),a._removeLoading()})()}clickOnRegistrarEntidad(){var t=this;return(0,d.Z)(function*(){yield t._showLoading("Registrando nueva entidad..."),(yield t._entidadesCrud.create(t.myForm.model)).fold({right:a=>{t._removeLoading(),t.isModalOpen=!1,t.myForm.reset()},left:a=>{t._removeLoading(),t._alertNotCreated()}})})()}_alertNotCreated(){var t=this;return(0,d.Z)(function*(){yield(yield t._alertController.create({header:"Estado de la entidad",message:"Error al crear entidad, puede que ya exista un usuario con este documento",buttons:["OK"]})).present()})()}_fetchEntidades(t=!1){var o=this;return(0,d.Z)(function*(){yield o._showLoading(),(yield o._entidadesCrud.fetch([1],t)).fold({right:_=>{o._instanceDataSource(_)}}),o._removeLoading()})()}_showLoading(t="Obteniendo entidades registradas..."){var o=this;return(0,d.Z)(function*(){o._loading=yield o._loadingCtrl.create({message:t}),o._loading.present(),o._cd.markForCheck()})()}_removeLoading(){this._loading.remove(),this._cd.markForCheck()}_instanceDataSource(t){this.dataSource=new f.by(t),this._cd.markForCheck()}ngOnDestroy(){this._subs1.unsubscribe()}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(Z.d),e.Y36(i.Br),e.Y36(i.HT),e.Y36(e.sBO))},n.\u0275cmp=e.Xpm({type:n,selectors:[["app-entidades"]],standalone:!0,features:[e.jDz],decls:19,vars:6,consts:[[1,"tab-container","ion-padding"],[1,"tab-content"],["slot","start"],[3,"click"],["name","add-outline"],["slot","end"],["name","refresh-outline"],["labelPlacement","floating","label","Buscar",3,"formControl"],["slot","end",4,"ngIf"],["class","tab-card",4,"ngFor","ngForOf"],[3,"isOpen","backdropDismiss"],["color","dark",3,"click"],["name","close-outline"],[1,"tab-card"],[1,"card-sub-in-title"],[4,"ngIf"],["style","max-width: 100px; margin-top: -10px",4,"ngIf"],[2,"padding","0 10px"],[2,"max-width","100px","margin-top","-10px"],["placeholder","Evaluar",2,"padding","10px",3,"ionChange"],[3,"value"],["label","Numero de documento","placeholder","Numero de documento",3,"formControl"],["label","Nombre completo","placeholder","Nombre completo",3,"formControl"],["label","Telefono","placeholder","Telefono",3,"formControl"],[2,"text-align","center"],[3,"disabled","click"]],template:function(t,o){1&t&&(e.TgZ(0,"div",0)(1,"section",1)(2,"ion-toolbar")(3,"ion-buttons",2)(4,"ion-button",3),e.NdJ("click",function(){return o.clickOnToggleModal(!0)}),e._UZ(5,"ion-icon",4),e.qZA()(),e.TgZ(6,"ion-label")(7,"b"),e._uU(8),e.qZA()(),e.TgZ(9,"ion-buttons",5)(10,"ion-button",3),e.NdJ("click",function(){return o.refresh()}),e._UZ(11,"ion-icon",6),e.qZA()()(),e.TgZ(12,"ion-item"),e._UZ(13,"ion-input",7),e.YNc(14,x,3,0,"ion-buttons",8),e.qZA()()(),e.TgZ(15,"ion-content"),e.YNc(16,y,20,12,"ion-card",9),e.qZA(),e.TgZ(17,"ion-modal",10),e.YNc(18,P,20,4,"ng-template"),e.qZA()),2&t&&(e.xp6(8),e.hij("",o.dataSource.data.length," ENTIDADES REGISTRADAS"),e.xp6(5),e.Q6J("formControl",o.filter),e.xp6(1),e.Q6J("ngIf",o.filter.value),e.xp6(2),e.Q6J("ngForOf",o.dataSource.filteredData),e.xp6(1),e.Q6J("isOpen",o.isModalOpen)("backdropDismiss",!1))},dependencies:[i.Pc,i.YG,i.Sm,i.PM,i.FN,i.Zi,i.tO,i.Dq,i.W2,i.Gu,i.gu,i.pK,i.Ie,i.Q$,i.q_,i.t9,i.n0,i.wd,i.sr,i.ki,i.QI,i.j9,m.ez,m.sg,m.O5,l.UX,l.JJ,l.oH,l.u5,h.D,v.G],styles:[".card-sub-in-title[_ngcontent-%COMP%]{font-size:10px;color:#666}.ion-title[_ngcontent-%COMP%]{font-weight:bolder;font-size:14px}.ion-subtitle[_ngcontent-%COMP%]{color:gray;font-size:12px;font-weight:600}.eva1-nombre[_ngcontent-%COMP%], .eva1-documental[_ngcontent-%COMP%]{margin-top:10px}ion-checkbox[_ngcontent-%COMP%] > span[_ngcontent-%COMP%]{margin-left:10px;margin-top:3px;float:right}ion-checkbox[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:24px;margin-left:10px}"],changeDetection:0}),n})()}}]);